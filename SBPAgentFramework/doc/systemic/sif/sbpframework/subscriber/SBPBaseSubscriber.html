<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_51) on Tue Nov 14 13:45:53 WST 2017 -->
<title>SBPBaseSubscriber</title>
<meta name="date" content="2017-11-14">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="SBPBaseSubscriber";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/SBPBaseSubscriber.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../systemic/sif/sbpframework/subscriber/SBPNoDOCSubscriber.html" title="class in systemic.sif.sbpframework.subscriber"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?systemic/sif/sbpframework/subscriber/SBPBaseSubscriber.html" target="_top">Frames</a></li>
<li><a href="SBPBaseSubscriber.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">systemic.sif.sbpframework.subscriber</div>
<h2 title="Class SBPBaseSubscriber" class="title">Class SBPBaseSubscriber</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>systemic.sif.sifcommon.BaseInfo</li>
<li>
<ul class="inheritance">
<li>systemic.sif.sifcommon.subscriber.BaseSubscriber</li>
<li>
<ul class="inheritance">
<li><a href="../../../../systemic/sif/sbpframework/subscriber/SyncSubscriber.html" title="class in systemic.sif.sbpframework.subscriber">systemic.sif.sbpframework.subscriber.SyncSubscriber</a></li>
<li>
<ul class="inheritance">
<li>systemic.sif.sbpframework.subscriber.SBPBaseSubscriber</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd>java.lang.Runnable, openadk.library.QueryResults, openadk.library.Subscriber</dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="strong">SBPBaseSubscriber</span>
extends <a href="../../../../systemic/sif/sbpframework/subscriber/SyncSubscriber.html" title="class in systemic.sif.sbpframework.subscriber">SyncSubscriber</a></pre>
<div class="block">This class implements some of the functionality defined in the Australian SBP. This are all infrastructure level
 functions and include: Start-up Sync Control through a DB and a dependent Object cache. For details please refer to
 the SBP Agent Framework Developer's Guide.<p><p>
 
 <b>Note:</b><p>
 Subscribers that are part of the SBP must extend this SBPBaseSubscriber. If your agent deals with other SIF objects 
 than the ones defined in the SBP then you should extends the SBPNoDOCSubscriber class for these objects and not this
 class. If you use this class for any other SIF objects than defined in the SBP the behaviour is unknown, most likely
 will cause your agent to crash.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>Joerg Huber</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../systemic/sif/sbpframework/subscriber/SBPBaseSubscriber.html#SBPBaseSubscriber(java.lang.String, openadk.library.ElementDef)">SBPBaseSubscriber</a></strong>(java.lang.String&nbsp;subscriberID,
                 openadk.library.ElementDef&nbsp;dtd)</code>
<div class="block">Default constructor</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>abstract boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../systemic/sif/sbpframework/subscriber/SBPBaseSubscriber.html#doesObjectExistInTargetSystem(java.lang.String, java.util.List, openadk.library.SIFDataObject)">doesObjectExistInTargetSystem</a></strong>(java.lang.String&nbsp;sifObjectName,
                             java.util.List&lt;<a href="../../../../systemic/sif/sbpframework/persist/model/SIFObjectKey.html" title="class in systemic.sif.sbpframework.persist.model">SIFObjectKey</a>&gt;&nbsp;keyValues,
                             openadk.library.SIFDataObject&nbsp;sifObject)</code>
<div class="block">This method needs to be implemented by the actual subscriber developer.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>abstract void</code></td>
<td class="colLast"><code><strong><a href="../../../../systemic/sif/sbpframework/subscriber/SBPBaseSubscriber.html#onKeyError(openadk.library.SIFDataObject, openadk.library.Zone, boolean, openadk.library.EventAction, systemic.sif.sbpframework.exception.InvalidKeyException)">onKeyError</a></strong>(openadk.library.SIFDataObject&nbsp;sifObject,
          openadk.library.Zone&nbsp;zone,
          boolean&nbsp;isEvent,
          openadk.library.EventAction&nbsp;eventAction,
          <a href="../../../../systemic/sif/sbpframework/exception/InvalidKeyException.html" title="class in systemic.sif.sbpframework.exception">InvalidKeyException</a>&nbsp;invalidKeyException)</code>
<div class="block">This method is called if the processing of the object failed due to invalid key data.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../systemic/sif/sbpframework/subscriber/SBPBaseSubscriber.html#processObjectsWithoutDependencies()">processObjectsWithoutDependencies</a></strong>()</code>
<div class="block">Should be called every so often.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../systemic/sif/sbpframework/subscriber/SBPBaseSubscriber.html#requestDependentObjects()">requestDependentObjects</a></strong>()</code>
<div class="block">Sends a SIF Query for all dependent objects that are in the cache for this subscriber and application.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_systemic.sif.sbpframework.subscriber.SyncSubscriber">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;systemic.sif.sbpframework.subscriber.<a href="../../../../systemic/sif/sbpframework/subscriber/SyncSubscriber.html" title="class in systemic.sif.sbpframework.subscriber">SyncSubscriber</a></h3>
<code><a href="../../../../systemic/sif/sbpframework/subscriber/SyncSubscriber.html#sync(openadk.library.Zone)">sync</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_systemic.sif.sifcommon.subscriber.BaseSubscriber">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;systemic.sif.sifcommon.subscriber.BaseSubscriber</h3>
<code>debugOnEvent, debugOnQueryResults, finalise, getQueryResultsOptions, getSubscriptionOptions, onEvent, onQueryPending, onQueryResults, processEvent, processResponse, provision, reportSIFError, run, setQueryResultsOptions, setSubscriptionOptions, shutdownSubscriber, startConsumers</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_systemic.sif.sifcommon.BaseInfo">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;systemic.sif.sifcommon.BaseInfo</h3>
<code>getAgentConfig, getAgentID, getAgentProperties, getAgentProperty, getApplicationID, getDtd, getFrameworkProperties, getId, getMappings, getZoneByID, getZones, isValidZone, setAgentConfig, setAgentID, setAgentProperties, setApplicationID, setDtd, setFrameworkProperties, setId, setMappings, setZones</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="SBPBaseSubscriber(java.lang.String, openadk.library.ElementDef)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>SBPBaseSubscriber</h4>
<pre>public&nbsp;SBPBaseSubscriber(java.lang.String&nbsp;subscriberID,
                 openadk.library.ElementDef&nbsp;dtd)
                  throws java.lang.IllegalArgumentException</pre>
<div class="block">Default constructor<p>
 Initialises the subscriber and also checks if the object this subscriber is responsible for is supported by
 the DOC. If not then a IllegalArgumentException is raised and the error is logged.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>subscriberID</code> - The unique ID of the subscriber (ie. StudentPersonalSubscriber).</dd><dd><code>dtd</code> - The dtd for which this subscriber is responsible for.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="doesObjectExistInTargetSystem(java.lang.String, java.util.List, openadk.library.SIFDataObject)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doesObjectExistInTargetSystem</h4>
<pre>public abstract&nbsp;boolean&nbsp;doesObjectExistInTargetSystem(java.lang.String&nbsp;sifObjectName,
                                    java.util.List&lt;<a href="../../../../systemic/sif/sbpframework/persist/model/SIFObjectKey.html" title="class in systemic.sif.sbpframework.persist.model">SIFObjectKey</a>&gt;&nbsp;keyValues,
                                    openadk.library.SIFDataObject&nbsp;sifObject)</pre>
<div class="block">This method needs to be implemented by the actual subscriber developer. It shall check if the dependent
 object given by the sifObjectName parameter and the key given by the keyValues does exist in the target 
 system. If it exists then TRUE must be returned if it doesn't exist then FALSE must be returned.<p>
 If the DOC is enabled and this method returns TRUE for the given sifObjectName and keyValues then the
 SIF Object given by the sifObject parameter will be cached and its dependent objects will automatically be
 requested by an appropriate subscriber (which can be a subscriber in another agent).<p><p>
 
 The keyValues holds the primary key (name as xpath and value) of the dependent SIF Object. In most cases 
 this is a SIF refId, but in some cases can be something else. The keyValues parameter is a list of key 
 values in case the primary key is made up of a compound key. The list will be in the correct order as 
 defined by the SIF specification.<p><p>
 
 The parameter sifObjectName and keyValues are extracted from the sifObject. The sifObject is provided for
 convenience. There might be the need to get other information out of the sifObject parameter to implement
 this method successfully and therefore the availability of this parameter.<p><p>
 
 Example of parameters: StudentSchoolEnrollment
 <code>
 <StudentSchoolEnrollment RefId="A8C3D3E34B359D75101D00AA001A1652">
   <StudentPersonalRefId>D3E34B359D75101A8C3D00AA001A1652</StudentPersonalRefId>
   <SchoolInfoRefId>A4E33E359D99101A8C3D00AA001BB76E</SchoolInfoRefId>
   <MembershipType>01</MembershipType>
    .....
 </StudentSchoolEnrollment>
 </code>
 <p><p>
 For the above example object the 'sifObject' parameter would be StudentSchoolEnrollment object.
 The 'doesObjectExistInTargetSystem()' method would be called twice for the above object by the 
 SBPBaseSubscriber because there are 2 dependent objects: <p>
 - The Student with RefId=D3E34B359D75101A8C3D00AA001A1652<p>
 - The School with RefId=A4E33E359D99101A8C3D00AA001BB76E<p><p>
 
 The sifObjectName and keyValues parameters for the two calls would be:<p>
 1st Call (Student): sifObjectName=StudentPersonal<p>
                     keyValues[0].xpathToKey=@RefId, keyValues[0].keyValue=D3E34B359D75101A8C3D00AA001A1652<p>
 2nd Call (School) : sifObjectName=SchoolInfo<p>
                     keyValues[0].xpathToKey=@RefId, keyValues[0].keyValue=A4E33E359D99101A8C3D00AA001BB76E<p><p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>sifObjectName</code> - Name of the dependent SIF Object (i.e. StudentPersonal, SchoolInfo etc).</dd><dd><code>keyValues</code> - List of key values. Name of Key is an xpath into the dependent SIF Object, value is the 
                  actual value of key as extracted from the sifObject parameter.</dd><dd><code>sifObject</code> - The SIF Object as delivered from the ZIS.</dd>
<dt><span class="strong">Returns:</span></dt><dd>See description</dd></dl>
</li>
</ul>
<a name="onKeyError(openadk.library.SIFDataObject, openadk.library.Zone, boolean, openadk.library.EventAction, systemic.sif.sbpframework.exception.InvalidKeyException)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>onKeyError</h4>
<pre>public abstract&nbsp;void&nbsp;onKeyError(openadk.library.SIFDataObject&nbsp;sifObject,
              openadk.library.Zone&nbsp;zone,
              boolean&nbsp;isEvent,
              openadk.library.EventAction&nbsp;eventAction,
              <a href="../../../../systemic/sif/sbpframework/exception/InvalidKeyException.html" title="class in systemic.sif.sbpframework.exception">InvalidKeyException</a>&nbsp;invalidKeyException)</pre>
<div class="block">This method is called if the processing of the object failed due to invalid key data. Key data is either the object's primary key or
 the foreign keys of the referenced objects if they are marked as a dependency to be resolved in the Dependent Object Cache. Typical 
 reasons for an invalid primary or foreign key are:<br/><br/>
 
 - Key element/attribute (i.e. refId) missing<br/>
 - Key element/attribute (i.e. refId) null or empty<br/><br/>
 
 This method will be called as part of processEvent() or processResponse() method if the key conditions are not met when processing
 a SIF Event or SIF Response. The offending object is passed to the 'sifObject' parameter of this method. If the failure is caused by
 processing and event then the 'isEvent' parameter is set to TRUE and the 'eventAction' will hold ADD, CHANGE or DELETE to indicate the
 event type. If the failure is cause by processing a response then the 'isEvent' parameter is set to FALSE and the 'eventAction' is null.
 The cause of the failure is part of the'invalidKeyException' parameter. Since this parameter is an exception, the error message can
 be retrieved with the standard invalidKeyException.getMessage() method. It is up to the implementation if something else should be
 done with the exception.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>sifObject</code> - The object that caused the error, i.e. has invalid primary or foreign keys.</dd><dd><code>zone</code> - The zone from which the object was received.</dd><dd><code>isEvent</code> - Set to TRUE if the error occurred during event processing. FALSE if the error occurred during response processing.</dd><dd><code>eventAction</code> - If the error occurred during event processing then this value will hold the event action such as ADD, CHANGE or DELETE.
                    If the error occurred during response processing then this value will set to null!</dd><dd><code>invalidKeyException</code> - Holds information about the invalid key(s).</dd></dl>
</li>
</ul>
<a name="requestDependentObjects()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>requestDependentObjects</h4>
<pre>public&nbsp;void&nbsp;requestDependentObjects()</pre>
<div class="block">Sends a SIF Query for all dependent objects that are in the cache for this subscriber and application.
 This will iterate through all zones of this agent to ensure that all dependent objects that have been
 received from various zones are requested.<p>
 This method must only run if this subscriber is responsible for a SIF Object that has other SIF objects
 with a dependency on this object. For example the StudentPersonal is such an object because a number of 
 other SIF objects depend upon the StudentPersonal such as the StudentSchoolEnrollment, 
 StudentContactRelationship etc.</div>
</li>
</ul>
<a name="processObjectsWithoutDependencies()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>processObjectsWithoutDependencies</h4>
<pre>public&nbsp;void&nbsp;processObjectsWithoutDependencies()</pre>
<div class="block">Should be called every so often. This method will check if there are cached objects that have no 
 dependencies any more. If so the object can be processed by this subscriber and then removed from 
 the cache. This process is only required for objects that have dependencies such as StaffAssignment.
 For objects without dependencies such as StudentPersonal there is no need to run this method.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/SBPBaseSubscriber.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../systemic/sif/sbpframework/subscriber/SBPNoDOCSubscriber.html" title="class in systemic.sif.sbpframework.subscriber"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?systemic/sif/sbpframework/subscriber/SBPBaseSubscriber.html" target="_top">Frames</a></li>
<li><a href="SBPBaseSubscriber.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
